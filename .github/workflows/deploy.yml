# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘  ðŸš€ GitHub Pages è‡ªå‹•éƒ¨ç½²å·¥ä½œæµ                                              â•‘
# â•‘  ç•¶ push åˆ° main åˆ†æ”¯æ™‚è‡ªå‹•è§¸ç™¼éƒ¨ç½²                                          â•‘
# â•‘  å°ˆç‚ºæ‰‹ä½œäººè¨­è¨ˆï¼Œæä¾›å‹å–„çš„ä¸­æ–‡éŒ¯èª¤è¨Šæ¯ â¤ï¸                                     â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

name: ðŸš€ éƒ¨ç½²åˆ° GitHub Pages

on:
  # ç•¶ push åˆ° main åˆ†æ”¯æ™‚è§¸ç™¼
  push:
    branches: [ 'main' ]
  # å…è¨±æ‰‹å‹•è§¸ç™¼
  workflow_dispatch:

# è¨­ç½® GITHUB_TOKEN æ¬Šé™
permissions:
  contents: read
  pages: write
  id-token: write

# åªå…è¨±ä¸€å€‹ä¸¦è¡Œéƒ¨ç½²
concurrency:
  group: 'pages'
  cancel-in-progress: true

jobs:
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # ðŸ—ï¸ å»ºç½®ä»»å‹™
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  build:
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ“¥ å–å¾—ç¨‹å¼ç¢¼
        uses: actions/checkout@v4

      - name: ðŸŸ¢ è¨­å®š Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: ðŸ“¦ å®‰è£å¥—ä»¶
        run: npm ci

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ðŸ” é©—è­‰è¨­å®šæª”
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ðŸ” æª¢æŸ¥ç¶²ç«™è¨­å®š
        id: validate
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "  ðŸ” æ­£åœ¨æª¢æŸ¥æ‚¨çš„ site.config.json è¨­å®šæª”..."
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          
          # åŸ·è¡Œé©—è­‰è…³æœ¬
          npm run validate
          
          # æª¢æŸ¥æ˜¯å¦ç”Ÿæˆäº†éŒ¯èª¤å ±å‘Š
          if [ -f "CONFIG_ERRORS.md" ]; then
            echo ""
            echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            echo "  âš ï¸  ç™¼ç¾è¨­å®šå•é¡Œï¼Œä»¥ä¸‹æ˜¯è©³ç´°èªªæ˜Žï¼š"
            echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
            echo ""
            cat CONFIG_ERRORS.md
          
            # å°‡éŒ¯èª¤å ±å‘Šè¼¸å‡ºåˆ° GitHub Actions Summary
            echo "## âš ï¸ è¨­å®šæª”æª¢æŸ¥çµæžœ" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            cat CONFIG_ERRORS.md >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "---" >> $GITHUB_STEP_SUMMARY
          else
            echo ""
            echo "âœ… è¨­å®šæª”æª¢æŸ¥é€šéŽï¼"
            echo "## âœ… è¨­å®šæª”æª¢æŸ¥é€šéŽ" >> $GITHUB_STEP_SUMMARY
            echo "æ‚¨çš„ site.config.json è¨­å®šå®Œå…¨æ­£ç¢ºï¼" >> $GITHUB_STEP_SUMMARY
          fi

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ðŸ—ï¸ å»ºç½®ç¶²ç«™
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ðŸ—ï¸ å»ºç½®ç¶²ç«™
        id: build
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "  ðŸ—ï¸ é–‹å§‹å»ºç½®æ‚¨çš„ç¶²ç«™..."
          echo "  ðŸ“ è‡ªå‹•åµæ¸¬åˆ° repo åç¨±: ${{ github.event.repository.name }}"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # å˜—è©¦å»ºç½®ï¼Œæ•ç²è¼¸å‡º
          npm run build 2>&1 | tee build_output.log
          BUILD_EXIT_CODE=${PIPESTATUS[0]}
          
          if [ $BUILD_EXIT_CODE -ne 0 ]; then
            echo "BUILD_FAILED=true" >> $GITHUB_OUTPUT
            exit $BUILD_EXIT_CODE
          fi
        env:
          NODE_ENV: production
          # ðŸŽ¯ è‡ªå‹•è¨­å®š base è·¯å¾‘ï¼ŒFork æ”¹åä¹Ÿä¸æ€•ï¼
          VITE_BASE_PATH: /${{ github.event.repository.name }}/

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ðŸ“‹ å»ºç½®å¤±æ•—æ™‚çš„å‹å–„å ±å‘Š
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ðŸ“‹ ç”Ÿæˆå‹å–„éŒ¯èª¤å ±å‘Š
        if: failure()
        run: |
          echo ""
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "  ðŸŒŸ è®“æˆ‘å€‘ä¾†çœ‹çœ‹ç™¼ç”Ÿäº†ä»€éº¼å•é¡Œ..."
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          
          # ä½¿ç”¨å‹å–„éŒ¯èª¤å ±å‘Šå™¨åˆ†æžéŒ¯èª¤
          if [ -f "build_output.log" ]; then
            cat build_output.log | node scripts/friendly-error-reporter.js --github
          fi
          
          # å¦‚æžœå‹å–„å ±å‘Šå™¨æ²’æœ‰è¼¸å‡ºåˆ° Summaryï¼Œä½¿ç”¨å‚™ç”¨æ–¹æ¡ˆ
          if ! grep -q "å»ºç½®å•é¡Œå ±å‘Š" $GITHUB_STEP_SUMMARY 2>/dev/null; then
            echo "## âŒ ç¶²ç«™å»ºç½®å¤±æ•—" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "### ðŸ¤” å¯èƒ½çš„åŽŸå› " >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "1. **site.config.json è¨­å®šæª”æœ‰éŒ¯èª¤**" >> $GITHUB_STEP_SUMMARY
            echo "   - è«‹åŸ·è¡Œ \`npm run validate\` æª¢æŸ¥è¨­å®š" >> $GITHUB_STEP_SUMMARY
            echo "   - æˆ–ä½¿ç”¨ [JSONLint](https://jsonlint.com) æª¢æŸ¥ JSON æ ¼å¼" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "2. **åœ–ç‰‡æª”æ¡ˆè·¯å¾‘ä¸æ­£ç¢º**" >> $GITHUB_STEP_SUMMARY
            echo "   - ç¢ºèªåœ–ç‰‡æ”¾åœ¨ \`public/images/\` è³‡æ–™å¤¾" >> $GITHUB_STEP_SUMMARY
            echo "   - æª”æ¡ˆåç¨±è¦å®Œå…¨ä¸€è‡´ï¼ˆåŒ…æ‹¬å¤§å°å¯«ï¼‰" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "3. **ç¨‹å¼ç¢¼æœ‰èªžæ³•éŒ¯èª¤**" >> $GITHUB_STEP_SUMMARY
            echo "   - å¦‚æžœæ‚¨ä¿®æ”¹éŽ \`src/\` è³‡æ–™å¤¾çš„æª”æ¡ˆï¼Œè«‹æª¢æŸ¥æ˜¯å¦æœ‰éŒ¯èª¤" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "### ðŸ’¡ å»ºè­°çš„è™•ç†æ–¹å¼" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "1. åœ¨æœ¬æ©ŸåŸ·è¡Œ \`npm run validate\` æª¢æŸ¥è¨­å®š" >> $GITHUB_STEP_SUMMARY
            echo "2. åœ¨æœ¬æ©ŸåŸ·è¡Œ \`npm run dev\` é è¦½ç¶²ç«™" >> $GITHUB_STEP_SUMMARY
            echo "3. æŸ¥çœ‹å°ˆæ¡ˆä¸­çš„ \`CONFIG_GUIDE.md\` è¨­å®šæŒ‡å—" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "### ðŸ†˜ éœ€è¦å¹«åŠ©ï¼Ÿ" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "å¦‚æžœæ‚¨ä¸ç¢ºå®šæ€Žéº¼ä¿®æ­£ï¼Œæ­¡è¿Žåˆ° [GitHub Issues](../../issues) ç™¼å•ï¼" >> $GITHUB_STEP_SUMMARY
          fi

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ðŸ“¤ ä¸Šå‚³å»ºç½®çµæžœ
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - name: ðŸ“„ è¨­å®š Pages
        uses: actions/configure-pages@v4

      - name: ðŸ“¤ ä¸Šå‚³å»ºç½®çµæžœ
        uses: actions/upload-pages-artifact@v3
        with:
          path: './dist'

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # ðŸš€ éƒ¨ç½²ä»»å‹™
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: ðŸš€ éƒ¨ç½²åˆ° GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4

      - name: ðŸŽ‰ éƒ¨ç½²æˆåŠŸ
        run: |
          echo ""
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "  ðŸŽ‰ æ­å–œï¼æ‚¨çš„ç¶²ç«™å·²æˆåŠŸä¸Šç·šï¼"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "  ðŸŒ æ‚¨çš„ç¶²ç«™ç¶²å€ï¼š"
          echo "  ${{ steps.deployment.outputs.page_url }}"
          echo ""
          echo "  ðŸ’¡ æé†’ï¼šé¦–æ¬¡éƒ¨ç½²å¯èƒ½éœ€è¦å¹¾åˆ†é˜æ‰èƒ½çœ‹åˆ°ç¶²ç«™"
          echo ""
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          
          # è¼¸å‡ºåˆ° GitHub Actions Summary
          echo "## ðŸŽ‰ éƒ¨ç½²æˆåŠŸï¼" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "æ‚¨çš„ç¶²ç«™å·²ç¶“ä¸Šç·šå›‰ï¼" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸŒ ç¶²ç«™ç¶²å€" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "[${{ steps.deployment.outputs.page_url }}](${{ steps.deployment.outputs.page_url }})" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ’¡ å°æé†’" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "- é¦–æ¬¡éƒ¨ç½²å¯èƒ½éœ€è¦å¹¾åˆ†é˜æ‰èƒ½çœ‹åˆ°ç¶²ç«™" >> $GITHUB_STEP_SUMMARY
          echo "- å¦‚æžœçœ‹åˆ°èˆŠçš„å…§å®¹ï¼Œè«‹æŒ‰ Ctrl+F5 å¼·åˆ¶é‡æ–°æ•´ç†" >> $GITHUB_STEP_SUMMARY
          echo "- ä¸‹æ¬¡ä¿®æ”¹ \`site.config.json\` å¾Œï¼Œç¶²ç«™æœƒè‡ªå‹•æ›´æ–°" >> $GITHUB_STEP_SUMMARY
